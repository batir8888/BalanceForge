# Руководство пользователя BalanceForge

## Введение

BalanceForge — это плагин для Unity Editor, предназначенный для управления табличными данными игрового баланса. Плагин предоставляет удобный табличный интерфейс, похожий на Excel, для работы с ScriptableObject-ами прямо в Unity.

## Установка

1. Импортируйте пакет BalanceForge в ваш Unity проект
2. Убедитесь, что все скрипты успешно скомпилировались
3. В меню Unity появятся новые пункты для работы с плагином

## Начало работы

### Создание новой таблицы

Есть два способа создать таблицу баланса:

**Способ 1: Через мастер создания**

1. Откройте меню `Assets → Create → BalanceForge → Balance Table Wizard`
2. В открывшемся окне введите имя таблицы
3. Добавьте необходимые колонки:
   - Нажмите кнопку "Add Column"
   - Укажите название колонки
   - Выберите тип данных (String, Integer, Float, Boolean, Enum, Color, Vector2, Vector3, AssetReference)
   - Отметьте, является ли поле обязательным
4. Нажмите "Create Table"
5. Выберите место сохранения asset-файла

**Способ 2: Через меню Assets**

1. Правый клик в окне Project
2. Выберите `Create → BalanceForge → Balance Table`
3. Настройте структуру таблицы через Inspector

### Открытие редактора таблиц

1. Откройте меню `Window → BalanceForge → Table Editor`
2. В верхней панели выберите нужную таблицу из выпадающего списка
3. Таблица загрузится в редактор

## Работа с таблицей

### Навигация по интерфейсу

Окно редактора состоит из:

- **Панель инструментов** (вверху): выбор таблицы, кнопки управления
- **Область фильтров** (опционально): настройка условий фильтрации
- **Таблица данных** (центр): ячейки с данными
- **Строка состояния** (внизу): статистика и время последнего изменения

### Добавление данных

**Добавление строки:**

1. Нажмите кнопку "Add Row" на панели инструментов
2. Новая строка появится в конце таблицы
3. Заполните ячейки данными

**Добавление тестовых данных:**

Если таблица пустая, используйте кнопку "Add 10 Test Rows" для быстрого создания тестовых строк.

### Редактирование данных

**Редактирование ячейки:**

1. Кликните на нужную ячейку
2. Введите новое значение
3. Нажмите Enter или кликните вне ячейки для сохранения

**Типы данных и их редактирование:**

- **String** — текстовое поле
- **Integer** — целочисленное поле
- **Float** — поле с плавающей точкой
- **Boolean** — чекбокс
- **Enum** — выпадающий список предустановленных значений
- **Color** — палитра цветов
- **Vector2/Vector3** — поля для координат
- **AssetReference** — поле для перетаскивания Unity-объектов

### Работа с выделением

**Выделение строк:**

- Установите чекбокс слева от строки для единичного выделения
- Используйте чекбокс в заголовке таблицы для выделения всех строк

**Операции с выделенными строками:**

- Удаление: кнопка "Delete Selected" или клавиша Delete
- Информация о количестве выделенных строк отображается в строке состояния

### Сортировка данных

1. Кликните на заголовок колонки
2. Первый клик — сортировка по возрастанию (▲)
3. Второй клик — сортировка по убыванию (▼)
4. Третий клик — отмена сортировки

### Фильтрация данных

1. Нажмите кнопку "Filter" на панели инструментов
2. В появившейся панели нажмите "Add Filter"
3. Настройте условие:
   - Выберите колонку
   - Выберите оператор (Equals, Contains, Greater Than и т.д.)
   - Введите значение для сравнения
4. Добавьте дополнительные фильтры при необходимости
5. Выберите логический оператор (AND/OR) для комбинации условий
6. Нажмите "Apply"

**Операторы фильтрации:**

- **Equals** — точное совпадение
- **Not Equals** — не равно
- **Contains** — содержит подстроку
- **Starts With** — начинается с
- **Ends With** — заканчивается на
- **Greater Than** — больше чем
- **Less Than** — меньше чем

## Буфер обмена

### Копирование и вставка

**Копирование:**

1. Выделите ячейку
2. Нажмите Ctrl+C (Cmd+C на Mac)

**Вставка:**

1. Выделите целевую ячейку
2. Нажмите Ctrl+V (Cmd+V на Mac)

**Через контекстное меню:**

1. Правый клик на ячейке
2. Выберите "Copy" или "Paste"

## Отмена и повтор действий

Плагин поддерживает полную историю изменений:

- **Отмена**: Ctrl+Z (Cmd+Z) или кнопка "Undo"
- **Повтор**: Ctrl+Shift+Z или Ctrl+Y (Cmd+Shift+Z или Cmd+Y) или кнопка "Redo"

Поддерживаемые операции:
- Редактирование ячеек
- Добавление строк
- Удаление строк
- Множественное удаление

## Импорт и экспорт

### Экспорт в CSV

1. Нажмите кнопку "Import/Export"
2. Выберите "Export to CSV"
3. Укажите путь и имя файла
4. Нажмите "Сохранить"

Экспортируются все данные таблицы в формате CSV с заголовками.

### Импорт из CSV

1. Нажмите кнопку "Import/Export"
2. Выберите "Import from CSV"
3. Выберите CSV-файл
4. Если структура не совпадает, подтвердите импорт
5. Данные будут загружены в таблицу

**Важно:** При импорте:
- Автоматически определяются типы данных колонок
- Несовпадающие структуры могут привести к потере данных
- Рекомендуется создавать резервные копии перед импортом

## Валидация данных

### Запуск валидации

1. Нажмите кнопку "Validate" на панели инструментов
2. Система проверит все ячейки на соответствие правилам
3. Результаты отобразятся в виде уведомления

### Типы ошибок

- **Warning** — предупреждение (не критично)
- **Error** — ошибка (рекомендуется исправить)
- **Critical** — критическая ошибка (требует исправления)

### Правила валидации

- Обязательные поля не должны быть пустыми
- Числовые поля должны содержать корректные числа
- Enum поля должны содержать значения из предустановленного списка
- Можно добавить кастомные валидаторы через код

## Производительность

### Оптимизация для больших таблиц

Плагин оптимизирован для работы с большими объемами данных:

- **Виртуальная прокрутка**: отрисовываются только видимые строки
- **Кэширование**: значения ячеек кэшируются для быстрого доступа
- **Поддержка до 50,000+ строк** без потери производительности

### Индикаторы в интерфейсе

Строка состояния показывает:
- **Total**: общее количество строк в таблице
- **Displayed**: количество строк после фильтрации
- **Selected**: количество выделенных строк
- **Visible**: количество строк, отрисованных на экране

## Горячие клавиши

### Основные команды

- **Ctrl+C / Cmd+C** — копировать ячейку
- **Ctrl+V / Cmd+V** — вставить в ячейку
- **Ctrl+Z / Cmd+Z** — отменить действие
- **Ctrl+Y / Cmd+Y** — повторить действие
- **Ctrl+Shift+Z / Cmd+Shift+Z** — повторить действие (альтернатива)
- **Delete** — удалить выделенные строки

### Навигация

- **Tab** — переход к следующей ячейке
- **Enter** — подтвердить редактирование
- **Esc** — отменить редактирование ячейки

## Сохранение данных

### Автоматическое сохранение

Данные автоматически сохраняются при:
- Редактировании ячеек
- Добавлении/удалении строк
- Операциях отмены/повтора
- Импорте данных

### Ручное сохранение

Нажмите кнопку "Save" для принудительного сохранения всех изменений в asset-файл.

**Важно:** Изменения сохраняются в ScriptableObject, который является частью проекта Unity и контролируется системой версий (Git и т.д.).

## Типичные сценарии использования

### Создание таблицы характеристик персонажей

1. Создайте таблицу с колонками: Name (String), Health (Integer), Speed (Float), IsPlayable (Boolean)
2. Добавьте строки для каждого персонажа
3. Заполните характеристики
4. Экспортируйте в CSV для передачи дизайнерам
5. После правок импортируйте обратно

### Настройка баланса оружия

1. Создайте таблицу с колонками: WeaponName (String), Damage (Integer), FireRate (Float), WeaponModel (AssetReference)
2. Добавьте все виды оружия
3. Используйте сортировку по урону для анализа баланса
4. Применяйте фильтры для работы с подмножествами
5. Используйте отмену/повтор для экспериментов с значениями

### Локализация текстов

1. Создайте таблицу с колонками: TextID (String), English (String), Russian (String), Chinese (String)
2. Импортируйте существующие переводы из CSV
3. Используйте фильтры для поиска непереведенных текстов
4. Валидируйте заполненность обязательных полей

## Устранение неполадок

### Таблица не сохраняется

- Убедитесь, что файл не только для чтения (read-only)
- Проверьте права доступа к файлу
- Убедитесь, что файл не находится в папке Packages

### Низкая производительность

- Уменьшите количество одновременно применяемых фильтров
- Закройте неиспользуемые таблицы
- Перезапустите Unity Editor

### Данные не импортируются

- Проверьте формат CSV (кодировка UTF-8)
- Убедитесь, что разделитель — запятая
- Проверьте, что первая строка содержит заголовки

### Ошибки валидации

- Проверьте соответствие типов данных
- Убедитесь, что обязательные поля заполнены
- Проверьте правильность формата значений (например, числа не должны содержать буквы)

## Расширение функциональности

### Создание кастомных валидаторов

```csharp
using BalanceForge.Services;

public class CustomValidator : IValidator
{
    public bool Validate(object value)
    {
        // Ваша логика валидации
        return true;
    }
    
    public string GetErrorMessage()
    {
        return "Custom validation failed";
    }
}
```

### Добавление новых типов колонок

Плагин поддерживает расширение через код. Смотрите документацию для разработчиков для подробной информации.

## Советы и рекомендации

1. **Используйте осмысленные названия колонок** — это упростит работу с данными
2. **Экспортируйте резервные копии** перед массовыми изменениями
3. **Применяйте фильтры** для работы с подмножествами данных
4. **Используйте Enum** вместо String для ограниченного набора значений
5. **Регулярно валидируйте данные** для предотвращения ошибок
6. **Используйте отмену/повтор** для экспериментов с балансом
7. **Сохраняйте таблицы в системе контроля версий** для командной работы

## Техническая поддержка

При возникновении проблем или вопросов обращайтесь к технической документации проекта или к разработчикам.
